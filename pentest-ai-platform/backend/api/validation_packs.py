"""Validation pack proxy endpoints (stateless)."""
from fastapi import APIRouter, Request, Depends
from api.proxy import get_proxy, SecurityFlashProxy

router = APIRouter(tags=["Validation Packs"])


@router.post("/api/v1/runs/{run_id}/validation-packs")
async def create_validation_pack(run_id: str, request: Request, proxy: SecurityFlashProxy = Depends(get_proxy)):
    return await proxy.proxy_request(request, f"/api/v1/runs/{run_id}/validation-packs")


@router.get("/api/v1/runs/{run_id}/validation-packs")
async def list_validation_packs(run_id: str, request: Request, proxy: SecurityFlashProxy = Depends(get_proxy)):
    return await proxy.proxy_request(request, f"/api/v1/runs/{run_id}/validation-packs")


@router.get("/api/v1/validation-packs/{pack_id}")
async def get_validation_pack(pack_id: str, request: Request, proxy: SecurityFlashProxy = Depends(get_proxy)):
    return await proxy.proxy_request(request, f"/api/v1/validation-packs/{pack_id}")


@router.post("/api/v1/validation-packs/{pack_id}/submit")
async def submit_validation_pack(pack_id: str, request: Request, proxy: SecurityFlashProxy = Depends(get_proxy)):
    return await proxy.proxy_request(request, f"/api/v1/validation-packs/{pack_id}/submit")


@router.post("/api/v1/validation-packs/{pack_id}/approve/reviewer")
async def approve_validation_pack_reviewer(pack_id: str, request: Request, proxy: SecurityFlashProxy = Depends(get_proxy)):
    return await proxy.proxy_request(request, f"/api/v1/validation-packs/{pack_id}/approve/reviewer")


@router.post("/api/v1/validation-packs/{pack_id}/approve/engineer")
async def approve_validation_pack_engineer(pack_id: str, request: Request, proxy: SecurityFlashProxy = Depends(get_proxy)):
    return await proxy.proxy_request(request, f"/api/v1/validation-packs/{pack_id}/approve/engineer")


@router.post("/api/v1/validation-packs/{pack_id}/attach-evidence")
async def attach_evidence(pack_id: str, request: Request, proxy: SecurityFlashProxy = Depends(get_proxy)):
    return await proxy.proxy_request(request, f"/api/v1/validation-packs/{pack_id}/attach-evidence")


@router.post("/api/v1/validation-packs/{pack_id}/complete")
async def complete_validation_pack(pack_id: str, request: Request, proxy: SecurityFlashProxy = Depends(get_proxy)):
    return await proxy.proxy_request(request, f"/api/v1/validation-packs/{pack_id}/complete")


@router.post("/api/v1/validation-packs/{pack_id}/abort")
async def abort_validation_pack(pack_id: str, request: Request, proxy: SecurityFlashProxy = Depends(get_proxy)):
    return await proxy.proxy_request(request, f"/api/v1/validation-packs/{pack_id}/abort")


@router.post("/api/v1/findings/{finding_id}/validation-pack")
async def create_pack_for_finding(finding_id: str, request: Request, proxy: SecurityFlashProxy = Depends(get_proxy)):
    return await proxy.proxy_request(request, f"/api/v1/findings/{finding_id}/validation-pack")
