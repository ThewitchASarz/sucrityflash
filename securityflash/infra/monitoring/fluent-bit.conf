[SERVICE]
    Flush        5
    Daemon       Off
    Parsers_File parsers.conf
    Log_Level    info

[INPUT]
    Name              tail
    Path              /var/lib/docker/containers/*securityflash-api*.log
    Tag               api
    Parser            docker
    Refresh_Interval  5

[INPUT]
    Name              tail
    Path              /var/lib/docker/containers/*securityflash-worker*.log
    Tag               worker
    Parser            docker
    Refresh_Interval  5

[FILTER]
    Name record_modifier
    Match api
    Record service api

[FILTER]
    Name record_modifier
    Match worker
    Record service worker

# Ship to CloudWatch Logs (requires AWS credentials/region env vars)
[OUTPUT]
    Name              cloudwatch_logs
    Match             *
    region            ${CLOUDWATCH_LOG_REGION}
    log_group_name    ${CLOUDWATCH_LOG_GROUP}
    log_stream_prefix ${CLOUDWATCH_LOG_STREAM_PREFIX}
    auto_create_group true
    log_key           log

# Optional Stackdriver export (uses application default credentials)
[OUTPUT]
    Name       stackdriver
    Match      *
    resource   generic_node
    location   ${STACKDRIVER_LOCATION}
    log_id     ${STACKDRIVER_LOG_ID}
    workers    2
